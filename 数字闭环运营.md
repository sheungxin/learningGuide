

# 架构设计

## 数字闭环运营架构

![image-20201230110949471](%E6%95%B0%E5%AD%97%E9%97%AD%E7%8E%AF%E8%BF%90%E8%90%A5.assets/image-20201230110949471.png)

## 画像架构

![image-20201230111012106](%E6%95%B0%E5%AD%97%E9%97%AD%E7%8E%AF%E8%BF%90%E8%90%A5.assets/image-20201230111012106.png)

# 升级优化

## 标签制定优化

目前标签制定存在的问题，如下：

- 标签制定不够灵活，且不支持热发布
- 标签制定一定程度上耦合，多个标签聚合在一个任务中，不利用标签的维护（修改、发布、下线）
- 标签分层与标签耦合，目前二级分类作为标签的存储列，无法灵活调整标签位置
- 版本控制不完善，可能导致历史标签数据回溯异常
- 未建立标签数据质量体系，例如：缺少数据异常、数据缺失、数据版本过低等检测机制
- 标签打法单一，目前仅支持自定义插件任务、外部标签集成（不完善），可扩展spark sql任务插件、人群批量标签插件、组合标签插件等
- 标签修复时间过长，主要原因：es全量写入时间较长（主要原因）、标签粒度不够细
- T-1标签，实时性提升，例如：当前订单标签
- 缺少标签使用情况统计

参考：[20308 链路辅助工具—标签制定优化](http://wiki.zuche.com/pages/viewpage.action?pageId=198738250)

## 多样化标签

目前数据营销组开发维护的报表很多，并且业务方、数据分析师可能都有一些数据标签、报表需求，但是这些需求可能是临时的，为了方便各个方面的用户，可以及时查到自己的数据，且减少研发人员的工作量，现开发一个自动化抽取平台，支撑标签、报表,可以让业务方自己创建需要的标签、看板

参考：[20105 多样化标签（暂停）](http://wiki.zuche.com/pages/viewpage.action?pageId=185221346)

## 标签与业务数据打通

目前标签使用场景比较单一，仅用于数据划定场景，是否可以延伸到业务场景，例如：

1. 通常我们会通过标签数据或者临时任务圈定一部分人，然后进行用户触达服务。在决定是否进行本次触达前，是否可以实时的看一下近期业务指标
2. 用户触达后根据效果进行二次分群，例如：成单状态，且根据不同的人群进行N次触达
3. 通常会有很多报表需求，实际上各个指标都对应一个用户群体。如下所示：

![img](%E6%95%B0%E5%AD%97%E9%97%AD%E7%8E%AF%E8%BF%90%E8%90%A5.assets/image2019-6-26_15-32-21.png)

我们是否可以把以上任意一部分用户抽取出来，然后查看一下我们关心的业务指标数据或者标签数据，进行营销决策

探索计划：

-  报表与标签数据互通（依赖KuDu、Impala，任务需要对齐）
-  查看报表数据/文件中人员的标签情况
-  通过标签圈定数据后进行指标分析
-  标签数据结构二维化采用KuDu存储，impala混合查询
-  通过标签划定数据后看这些用户还具有其它标签

参考：[20307 impala基于kudu、parquet混合查询场景分析](http://wiki.zuche.com/pages/viewpage.action?pageId=194958171)

## 用户触达链路优化

- 简化用户触达链路
  - 数据工单与触达申请合并，数据准备还是必不可少，决定数据范围是否合理
  - 目前只能从数据划定记录上进行触达申请，且划定记录重复利用率过低，建议去除该环节
- 标签划定和临时工单结合，相互补充，目前数据划定只能二选一
- 数据过滤机制完善
- 用户触达体系化
  - 计划周期触达（待完善）
  - N次触达，结合用户行为进行玩法支持

参考：[20218 十一续租优惠发券支持（拉长租期）](http://wiki.zuche.com/pages/viewpage.action?pageId=200968066)

## 用户触达链路之主题分析

### 现状

- 目前仅针对单次触达进行效果分析，缺少汇总类分析，如：季度性按分类效果分析
- 多次用户触达可能具有相关性，例如目标、数据相关性等
- 分析方式比较单一

### 设想

![img](%E6%95%B0%E5%AD%97%E9%97%AD%E7%8E%AF%E8%BF%90%E8%90%A5.assets/%E7%94%A8%E6%88%B7%E8%A7%A6%E8%BE%BE%E9%93%BE%E8%B7%AF%E4%B9%8B%E4%B8%BB%E9%A2%98%E5%88%86%E6%9E%90.png)

参考：[20212 用户触达链路之主题分析](http://wiki.zuche.com/pages/viewpage.action?pageId=196636004)

# 实验与探索

- 用户触达推荐
- 新增2类实验性用户触达方式
  -  微信机器人
  -  微信服务号用户触发服务接入
    - 例如：可采用微信模板类消息发送通知类消息
-  模型和实时都各标签1组，打通流程
  -  机器学习标签
  -  实时标签尝试
-  探索实验—业务订单事件模型
  - 事件模型



![image-20201230141209280](%E6%95%B0%E5%AD%97%E9%97%AD%E7%8E%AF%E8%BF%90%E8%90%A5.assets/image-20201230141209280.png)



![image-20201230141149982](%E6%95%B0%E5%AD%97%E9%97%AD%E7%8E%AF%E8%BF%90%E8%90%A5.assets/image-20201230141149982.png)